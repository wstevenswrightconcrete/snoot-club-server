<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Snoot Club • Admin</title>

  <!-- Brand colors -->
  <style>
    :root{
      --sc-navy:#0D2139;
      --sc-silver:#B8BAB6;
      --sc-slate:#676F79;
      --sc-navy-dark:#081D35;
      --sc-navy-darker:#041932;
      --radius:14px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:var(--sc-navy);
      color:var(--sc-silver);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";
      -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    }

    /* Header */
    .app-header{
      display:flex; align-items:center; gap:14px;
      padding:18px 20px;
      border-bottom:1px solid var(--sc-navy-dark);
      background:linear-gradient(180deg, var(--sc-navy) 0%, var(--sc-navy-dark) 100%);
      position:sticky; top:0; z-index:10;
    }
    .logo{
      height:44px; width:auto; display:block;
      filter: drop-shadow(0 1px 0 var(--sc-navy-darker));
      user-select:none;
    }
    .brand{
      line-height:1.1;
    }
    .brand-title{
      font-size: clamp(18px, 2.4vw, 22px);
      letter-spacing:.04em; font-weight:700;
      color:var(--sc-silver);
    }
    .brand-sub{
      font-size:12px; color:var(--sc-slate); letter-spacing:.12em;
    }

    /* Page shell */
    .wrap{max-width:980px; margin:28px auto; padding:0 20px}
    .card{
      background:rgba(4,25,50,.55);
      border:1px solid var(--sc-navy-dark);
      border-radius:var(--radius);
      box-shadow:0 12px 30px rgba(4,25,50,.45), inset 0 1px 0 rgba(184,186,182,.06);
      padding:20px;
    }
    h1{margin:.2em 0 .6em; font-size:26px; color:var(--sc-silver)}

    /* Buttons / inputs */
    .row{display:flex; gap:10px; flex-wrap:wrap}
    input,button,select{
      font:inherit;
      border-radius:12px;
      border:1px solid var(--sc-navy-dark);
      background:#0b1f34;
      color:var(--sc-silver);
      padding:10px 12px;
      outline:none;
    }
    input::placeholder{color:#7e8792}
    button{
      background:linear-gradient(180deg, #0f2742 0%, #0b1f34 100%);
      border:1px solid var(--sc-navy-dark);
      font-weight:600; letter-spacing:.02em; cursor:pointer;
    }
    button:hover{filter:brightness(1.07)}
    button:active{transform:translateY(1px)}
    .muted{color:var(--sc-slate)}

    /* Small helpers */
    .spacer{height:14px}
  </style>

  <link rel="icon" href="./logo.png" />
</head>
<body>
  <header class="app-header">
    <!-- Use a relative path; fallback tries /admin/logo.png if needed -->
    <img class="logo" src="./logo.png" alt="Snoot Club" onerror="this.onerror=null;this.src='/admin/logo.png'">
    <div class="brand">
      <div class="brand-title">SNOOT CLUB</div>
      <div class="brand-sub">EST 1937 • ADMIN</div>
    </div>
  </header>

  <main class="wrap">
    <div class="card">
      <h1>Admin Dashboard</h1>

      <!-- example: your existing controls go here -->
      <div class="row">
        <input id="pin" placeholder="Enter Admin PIN" inputmode="numeric" maxlength="6" />
        <button id="adminLoginBtn">Unlock Admin</button>
      </div>

      <div class="spacer"></div>
      <div class="row">
        <input id="meetingTitle" placeholder="Meeting title" />
        <input id="meetingTime" type="datetime-local" />
        <button id="createBtn">Create Meeting</button>
      </div>

      <p class="muted" id="status"></p>
    </div>
  </main>

  <script>
    const $ = (s)=>document.querySelector(s);
    const statusEl = $("#status");

    // --- Admin login (PIN is requested server-side; no auto-login) ---
    $("#adminLoginBtn").addEventListener("click", async () => {
      const pin = $("#pin").value.trim();
      if(!pin){ statusEl.textContent = "Enter your admin PIN."; return; }
      statusEl.textContent = "Checking PIN…";
      try{
        const res = await fetch("/auth/admin", {
          method:"POST",
          headers:{ "content-type":"application/json" },
          body: JSON.stringify({ pin })
        });
        const data = await res.json();
        statusEl.textContent = data.ok ? "Admin unlocked." : (data.error || "PIN rejected.");
      }catch(e){
        statusEl.textContent = "Network error.";
      }
    });

    // --- Create meeting (requires x-admin-pin header set server-side or cookie-based admin auth) ---
    $("#createBtn").addEventListener("click", async () => {
      const title = $("#meetingTitle").value.trim();
      const startsAtLocal = $("#meetingTime").value;
      if(!title || !startsAtLocal){
        statusEl.textContent = "Title and time required.";
        return;
      }
      statusEl.textContent = "Creating…";
      try{
        const resp = await fetch("/meetings", {
          method:"POST",
          headers:{ "content-type":"application/json" /* server will check admin auth */ },
          body: JSON.stringify({ title, startsAt: new Date(startsAtLocal).toISOString() })
        });
        const data = await resp.json();
        statusEl.textContent = data.ok ? "Meeting created." : (data.error || "Failed.");
      }catch(e){
        statusEl.textContent = "Network error.";
      }
    });
  </script>
</body>
</html>
